<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Taxas Asaas</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .resultado { background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .taxa-info { color: #856404; font-size: 0.9em; }
    </style>
</head>
<body>
    <h2>Teste de Cálculo das Taxas do Asaas</h2>
    
    <label for="valor">Valor do produto (R$):</label>
    <input type="number" id="valor" value="100" step="0.01" onchange="calcularTodas()">
    
    <div id="resultados"></div>

    <script>
        // Taxas do Asaas para cartão de crédito (baseadas na tabela oficial)
        // À vista (1x) não cobra taxas, somente a partir de 2x
        const asaasTaxas = {
            1: { taxa: 0, adicional: 0 },          // À vista: sem taxas
            2: { taxa: 3.49, adicional: 0.49 },   // 2 a 6 parcelas: R$ 0,49 + 3,49%
            3: { taxa: 3.49, adicional: 0.49 },
            4: { taxa: 3.49, adicional: 0.49 },
            5: { taxa: 3.49, adicional: 0.49 },
            6: { taxa: 3.49, adicional: 0.49 },
            7: { taxa: 3.99, adicional: 0.49 },   // 7 a 12 parcelas: R$ 0,49 + 3,99%
            8: { taxa: 3.99, adicional: 0.49 },
            9: { taxa: 3.99, adicional: 0.49 },
            10: { taxa: 3.99, adicional: 0.49 },
            11: { taxa: 3.99, adicional: 0.49 },
            12: { taxa: 4.29, adicional: 0.49 }   // 13 a 21 parcelas: R$ 0,49 + 4,29%
        };

        // Calcular valor total com taxas do Asaas
        function calcularValorComTaxas(valorOriginal, parcelas) {
            const config = asaasTaxas[parcelas];
            if (!config) return { valorTotal: valorOriginal, valorParcela: valorOriginal };
            
            // Calcular taxa percentual
            const taxaPercentual = valorOriginal * (config.taxa / 100);
            
            // Somar taxa fixa + taxa percentual
            const valorTotal = valorOriginal + config.adicional + taxaPercentual;
            
            // Calcular valor da parcela
            const valorParcela = valorTotal / parcelas;
            
            return {
                valorTotal: valorTotal,
                valorParcela: valorParcela,
                taxaAplicada: config.adicional + taxaPercentual,
                taxaPercentual: taxaPercentual,
                taxaFixa: config.adicional
            };
        }

        function formatPrice(price) {
            return price.toFixed(2).replace('.', ',');
        }

        function calcularTodas() {
            const valor = parseFloat(document.getElementById('valor').value) || 100;
            const container = document.getElementById('resultados');
            
            let html = `<h3>Valor original: R$ ${formatPrice(valor)}</h3>`;
            
            for (let i = 1; i <= 12; i++) {
                const resultado = calcularValorComTaxas(valor, i);
                const diferenca = resultado.valorTotal - valor;
                
                html += `
                    <div class="resultado">
                        <strong>${i}x de R$ ${formatPrice(resultado.valorParcela)}</strong> = R$ ${formatPrice(resultado.valorTotal)}
                        <div class="taxa-info">
                            Taxa fixa: R$ ${formatPrice(resultado.taxaFixa)} | 
                            Taxa %: R$ ${formatPrice(resultado.taxaPercentual)} | 
                            Total em taxas: R$ ${formatPrice(diferenca)}
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        // Calcular ao carregar a página
        calcularTodas();
    </script>
</body>
</html>